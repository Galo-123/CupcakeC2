import{_ as G,o as J,b as L,c as K,e,w as t,g as C,E as c,h as s,m as p,I as O,J as H,s as R,d as i,t as U,q as m,u as b,Q as X,a3 as Y,a4 as Z,a5 as ee,j as le,D as ae}from"./index-DG_0wL7P.js";const te={class:"plugin-management-page"},ne={class:"card-header"},oe={class:"header-left"},se={class:"header-right"},ue={class:"plugin-name"},ie={__name:"DomainScanner",setup(de){const w=p(!1),x=p([]),g=p(""),f=p(!1),h=p(!1),o=p({name:"",description:"",required_os:"windows",type:"execute-assembly",category:"general",file:null}),T=le(()=>{if(!g.value)return x.value;const a=g.value.toLowerCase();return x.value.filter(l=>l.name.toLowerCase().includes(a)||l.description&&l.description.toLowerCase().includes(a)||l.type.toLowerCase().includes(a))}),S=a=>{a==="memfd-exec"&&(o.value.required_os="linux"),(a==="execute-assembly"||a==="inject-shellcode")&&(o.value.required_os="windows")},j=a=>{o.value.file=a.raw},V=async()=>{w.value=!0;try{const a=await C.get("/api/plugins");x.value=a.data}catch{c.error("获取插件列表失败")}finally{w.value=!1}},B=async()=>{var l,_;if(!o.value.file||!o.value.name)return c.warning("请填写必要的信息并选择文件");h.value=!0;const a=new FormData;a.append("file",o.value.file),a.append("name",o.value.name),a.append("description",o.value.description),a.append("type",o.value.type),a.append("required_os",o.value.required_os),a.append("category",o.value.category);try{await C.post("/api/plugins/upload",a,{headers:{"Content-Type":"multipart/form-data"}}),c.success("插件注册并上传成功"),f.value=!1,V(),o.value={name:"",description:"",required_os:"windows",type:"execute-assembly",category:"general",file:null}}catch(d){c.error("上传失败: "+(((_=(l=d.response)==null?void 0:l.data)==null?void 0:_.error)||d.message))}finally{h.value=!1}},E=a=>{ae.confirm("确定要从武器库中移除该插件及其文件吗？","删除确认",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await C.delete(`/api/plugins/${a}`),c.success("插件已移除"),V()}catch{c.error("删除失败")}})},M=a=>({"execute-assembly":"warning","memfd-exec":"success","inject-shellcode":"danger","native-exec":""})[a]||"info",N=a=>({"execute-assembly":"C# 内存加载 (ExecuteAssembly)","memfd-exec":"Linux 内存执行 (Memfd)","inject-shellcode":"Shellcode 注入 (Injection)","native-exec":"原生可执行运行 (Native)"})[a]||a,z=a=>!a||a==="multi"||a==="any"?"全平台":a==="windows"?"Windows":a==="linux"?"Linux":a.charAt(0).toUpperCase()+a.slice(1);return J(V),(a,l)=>{const _=s("el-icon"),d=s("el-input"),y=s("el-button"),v=s("el-table-column"),k=s("el-tag"),P=s("el-table"),$=s("el-card"),r=s("el-form-item"),D=s("el-col"),u=s("el-option"),q=s("el-select"),A=s("el-row"),F=s("el-upload"),I=s("el-form"),W=s("el-dialog"),Q=O("loading");return L(),K("div",te,[e($,{shadow:"never",class:"main-card"},{header:t(()=>[i("div",ne,[i("div",oe,[e(_,{class:"header-icon"},{default:t(()=>[e(b(Y))]),_:1}),l[9]||(l[9]=i("span",{class:"header-title"},"全局插件管理 (Payload Arsenal)",-1))]),i("div",se,[e(d,{modelValue:g.value,"onUpdate:modelValue":l[0]||(l[0]=n=>g.value=n),placeholder:"搜索插件...",class:"search-input","prefix-icon":"Search",clearable:""},null,8,["modelValue"]),e(y,{type:"primary",icon:b(Z),onClick:l[1]||(l[1]=n=>f.value=!0)},{default:t(()=>[...l[10]||(l[10]=[m(" 上传新插件 ",-1)])]),_:1},8,["icon"])])])]),default:t(()=>[H((L(),R(P,{data:T.value,border:"",stripe:"",class:"plugin-table"},{default:t(()=>[e(v,{label:"插件名称","min-width":"140"},{default:t(({row:n})=>[i("span",ue,U(n.name),1)]),_:1}),e(v,{prop:"description",label:"功能描述","min-width":"200","show-overflow-tooltip":""}),e(v,{label:"目标平台",width:"140",align:"center"},{default:t(({row:n})=>[e(k,{type:n.required_os==="windows"?"primary":n.required_os==="linux"?"success":"info",size:"default","disable-transitions":""},{default:t(()=>[m(U(z(n.required_os)),1)]),_:2},1032,["type"])]),_:1}),e(v,{label:"执行方式",width:"240",align:"center"},{default:t(({row:n})=>[e(k,{type:M(n.type),effect:"light"},{default:t(()=>[m(U(N(n.type)),1)]),_:2},1032,["type"])]),_:1}),e(v,{label:"操作",width:"80",align:"center",fixed:"right"},{default:t(({row:n})=>[e(y,{type:"danger",size:"small",icon:b(X),circle:"",onClick:re=>E(n.id)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])),[[Q,w.value]])]),_:1}),e(W,{modelValue:f.value,"onUpdate:modelValue":l[8]||(l[8]=n=>f.value=n),title:"上传受控端插件",width:"500px"},{footer:t(()=>[e(y,{onClick:l[7]||(l[7]=n=>f.value=!1)},{default:t(()=>[...l[12]||(l[12]=[m("取消",-1)])]),_:1}),e(y,{type:"primary",loading:h.value,onClick:B},{default:t(()=>[...l[13]||(l[13]=[m("立即上传注册",-1)])]),_:1},8,["loading"])]),default:t(()=>[e(I,{"label-position":"top"},{default:t(()=>[e(A,{gutter:20},{default:t(()=>[e(D,{span:14},{default:t(()=>[e(r,{label:"插件名称",required:""},{default:t(()=>[e(d,{modelValue:o.value.name,"onUpdate:modelValue":l[2]||(l[2]=n=>o.value.name=n),placeholder:"如: SharpKatz, Mimikatz..."},null,8,["modelValue"])]),_:1})]),_:1}),e(D,{span:10},{default:t(()=>[e(r,{label:"目标操作系统",required:""},{default:t(()=>[e(q,{modelValue:o.value.required_os,"onUpdate:modelValue":l[3]||(l[3]=n=>o.value.required_os=n),class:"w-full"},{default:t(()=>[e(u,{label:"Windows",value:"windows"}),e(u,{label:"Linux",value:"linux"}),e(u,{label:"Multi-platform",value:"multi"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(r,{label:"功能描述",required:""},{default:t(()=>[e(d,{modelValue:o.value.description,"onUpdate:modelValue":l[4]||(l[4]=n=>o.value.description=n),type:"textarea",rows:2,placeholder:"简述该插件的主要公能..."},null,8,["modelValue"])]),_:1}),e(r,{label:"下发执行方式",required:""},{default:t(()=>[e(q,{modelValue:o.value.type,"onUpdate:modelValue":l[5]||(l[5]=n=>o.value.type=n),class:"w-full",onChange:S},{default:t(()=>[e(u,{label:"C# .NET 反射执行 (execute-assembly)",value:"execute-assembly"}),e(u,{label:"Linux 内存执行 (memfd-exec)",value:"memfd-exec"}),e(u,{label:"Windows Shellcode 注入 (inject-shellcode)",value:"inject-shellcode"}),e(u,{label:"原生可执行文件直接运行",value:"native-exec"})]),_:1},8,["modelValue"])]),_:1}),e(r,{label:"功能分类"},{default:t(()=>[e(q,{modelValue:o.value.category,"onUpdate:modelValue":l[6]||(l[6]=n=>o.value.category=n),class:"w-full"},{default:t(()=>[e(u,{label:"凭据窃取 (Credentials)",value:"credentials"}),e(u,{label:"内网横向 (Lateral)",value:"lateral"}),e(u,{label:"环境探测 (Enum)",value:"enum"}),e(u,{label:"提权工具 (Privesc)",value:"privesc"}),e(u,{label:"其他 (General)",value:"general"})]),_:1},8,["modelValue"])]),_:1}),e(r,{label:"插件文件 (.exe, .elf, .bin, .dll)",required:""},{default:t(()=>[e(F,{drag:"",action:"#","auto-upload":!1,limit:1,"on-change":j,class:"upload-box"},{default:t(()=>[e(_,{class:"el-icon--upload"},{default:t(()=>[e(b(ee))]),_:1}),l[11]||(l[11]=i("div",{class:"el-upload__text"},[m("拖拽文件至此 或 "),i("em",null,"点击选择文件")],-1))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},pe=G(ie,[["__scopeId","data-v-b3dd28d6"]]);export{pe as default};
