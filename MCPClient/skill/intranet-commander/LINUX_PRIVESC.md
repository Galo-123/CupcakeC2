# Linux 权限与配置安全审计指南 (Defensive)

本指南用于在**授权范围内**对 Linux 主机进行权限与配置审计，输出风险项与加固建议。内容聚焦“最小权限、最小暴露、可审计”，避免提供利用细节。

## 1. 范围与只读优先 (Scope & Read-Only First)

*   明确发行版、用途（应用/数据库/容器宿主机/跳板等）与组织安全基线标准。
*   优先只读采集证据；任何配置变更必须走变更流程并准备回滚方案。

---

## 2. 重点检查项 (What To Review)

### A. 账户与认证 (Accounts & Auth)
*   本地账号清单与最小化：是否存在默认账号、共享账号、长期闲置账号。
*   SSH：是否禁用 root 直登、是否限制密码登录、是否启用多因素（按组织要求）。
*   sudo/su：是否按最小权限配置；是否开启审计与集中化；是否存在高风险免密策略。
*   凭据治理：配置文件/脚本中是否存在明文密码、Token、私钥；私钥权限是否正确。

### B. 权限与文件系统 (Permissions & Filesystem)
*   关键目录权限基线：`/etc`、`/var/log`、应用目录、备份目录、密钥目录。
*   SUID/SGID 与文件 capabilities：是否确有业务必要；是否存在历史遗留与可替代实现。
*   PATH 与可写目录治理：避免可写目录出现在 PATH 前部；按基线限制可写可执行路径。
*   临时目录与共享内存目录：权限与挂载参数是否符合组织基线（如 `noexec`、`nosuid` 等按需启用）。

### C. 服务与网络暴露面 (Services & Exposure)
*   监听端口与对外暴露服务清单是否与业务一致；是否存在历史遗留服务。
*   systemd 服务权限：是否限制运行用户、文件系统访问、网络访问与能力边界（按组织可用性）。
*   防火墙与分段策略：nftables/iptables/ufw 配置是否落地且与网络分段一致。

### D. 补丁与内核 (Patching)
*   操作系统与关键组件的补丁基线是否满足要求；是否有明确的更新与重启策略（结合业务窗口）。

### E. 审计与日志 (Audit & Logs)
*   auditd/journald/rsyslog 是否配置合理并集中化；关键事件是否有告警闭环。
*   SSH 登录失败、sudo 关键操作、权限变更等是否可观测、可追溯。

---

## 3. 输出模板 (Finding Template)

*   风险项 -> 证据 -> 影响 -> 建议 -> 复测

---

## 4. 关联指南

*   容器与 K8s 安全审计：`CONTAINER_EXPLOIT.md`
*   审计操作规范与证据管理：`OPSEC_STEALTH.md`
